---
title: "EXPLORATORY DATA ANALYSIS"
output: html_document
date: "2025-03-10"
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggplot2)
library(lubridate)
```

# Load the data
```{r}
intervals <- read.csv("C:/Users/NP/OneDrive/Desktop/GWU/Intro-to-R/DATS6101_Project/data/fitbit/timestep_data/intervals.csv")

head(intervals)
str(intervals)
```

```{r}
intervals$day_of_week <- factor(intervals$day_of_week, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
```


```{r}
cor(intervals$avg_steps, intervals$avg_calories)
cor(intervals$avg_steps, intervals$avg_mets)
cor(intervals$avg_calories, intervals$avg_mets)
```
**There is a positive correlation between steps and calories burned, steps and METs, and calories burned and METs**

```{r}
# correlation matrix
correlation_matrix <- cor(intervals[, c("avg_steps", "avg_calories", "avg_mets")])
correlation_matrix

library(ggcorrplot)

ggcorrplot(correlation_matrix, hc.order = TRUE, type = "lower", lab = TRUE)

```
**The correlation matrix shows that there is a positive correlation between steps and calories burned, steps and METs, and calories burned and METs**

**The correlation matrix also shows that the correlation between steps and calories burned is the strongest**


```{r}
# correlation plot
ggplot(intervals, aes(x = avg_steps, y = avg_calories)) +
  geom_point() +
  ggtitle("Scatterplot of Steps vs. Calories Burned") +
  xlab("Steps") +
  ylab("Calories") +
  geom_smooth(method = "lm")
```
**the scatterplot shows a positive linear relationship between steps and calories burned**

```{r}
ggplot(intervals, aes(x = avg_steps)) +
  geom_histogram(fill = "yellow", color = "black", bins = 30) +
  ggtitle("Distribution of Steps Taken") +
  xlab("Steps")

ggplot(intervals, aes(x = avg_calories)) +
  geom_histogram(fill = "red", color = "black", bins = 30) +
  ggtitle("Distribution of Calories Burned") +
  xlab("Calories Burned")
```
**graphs show that the distribution of steps taken and calories burned are right-skewed**


# correlation matrix
```{r}
# Compute correlation matrix
cor_matrix <- cor(intervals[, c("avg_steps", "avg_sleep", "avg_intensity", "avg_calories", "avg_mets")],
                  use = "complete.obs")
cor_matrix

# Visualizing correlation matrix
library(ggcorrplot)
ggcorrplot(cor_matrix, method = "circle", lab = TRUE, colors = c("red", "white", "blue"))

```
**The graph shows that there is a positive correlation between steps and calories burned, steps and METs, and calories burned and METs**
**The correlation matrix also shows that the correlation between steps and calories burned is the strongest**

# time series analysis
```{r}

# Convert interval_start to Date-Time format
intervals$interval_start <- as.POSIXct(intervals$interval_start, format="%Y-%m-%d%H:%M:%S")

head(intervals$interval_start)

# Extract additional time-based features
intervals$hour <- hour(intervals$interval_start)
intervals$day_of_week <- weekdays(intervals$interval_start)
intervals$month <- month(intervals$interval_start)
intervals$year <- year(intervals$interval_start)

head(intervals)

```
**The data has been converted to Date-Time format and additional time-based features have been extracted**

```{r}
# Plotting steps over time
ggplot(intervals, aes(x = interval_start, y = avg_steps)) +
  geom_line() +
  ggtitle("Steps Over Time") +
  xlab("Date") +
  ylab("Steps")


```


```{r}
# Aggregating data by day
daily_data <- intervals %>%
  group_by(date = as.Date(interval_start)) %>%
  summarise(
    avg_steps = mean(avg_steps, na.rm = TRUE),
    avg_sleep = mean(avg_sleep, na.rm = TRUE),
    avg_calories = mean(avg_calories, na.rm = TRUE),
    avg_mets = mean(avg_mets, na.rm = TRUE)
  )

head(daily_data)

# Plotting steps over time
ggplot(daily_data, aes(x = date, y = avg_steps)) +
  geom_line() +
  ggtitle("Daily Average Steps Over Time") +
  xlab("Date") +
  ylab("Average Steps")
```
**The time series plot shows that the average number of steps taken fluctuates over time **
**But the number of steps taken seems to increase over time**

```{r}
# scatter plot

ggplot(intervals, aes(x = hour, y = avg_steps, color = day_of_week)) +
  geom_point() +
  ggtitle("Average Steps by Hour and Day of the Week") +
  xlab("Hour") +
  ylab("Average Steps")

```
**The graph plot indicates what time of day and what days of the week are people most active**
**people are most active on tuesday's in the evening time**